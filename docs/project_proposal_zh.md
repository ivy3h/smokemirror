# 项目提案：SmokeMirror

## 基于悬念感知的双层叙事生成框架：面向推理小说的情节控制

---

## 1. 研究动机与问题陈述

### 1.1 研究背景

大型语言模型（LLM）在创意文本生成方面展现了卓越能力，但生成具有复杂叙事结构的**长篇推理小说**仍面临重大挑战。推理小说的核心特征包括：

1. **双层叙事结构**：读者知道真相（谁是凶手），而侦探角色在虚假信息中调查——形成持续的戏剧性反讽。

2. **阴谋与误导**：多个共谋者协调配合，误导调查方向，同时保持内部一致性。

3. **悬念管理**：故事需要通过"险些发现真相"、策略性干预和节奏化揭示来维持张力。

4. **长程连贯性**：早期引入的情节元素必须在数万字的篇幅中保持一致并最终收束。

### 1.2 现有方法的局限

当前基于LLM的故事生成系统缺乏：
- 管理双重视角的显式机制（读者知识 vs. 角色知识）
- 悬念曲线优化的结构化方法
- 阴谋动态的多智能体协调

### 1.3 研究问题

1. **RQ1**：如何设计一个生成框架，在长篇叙事中维护读者和角色的独立知识状态？

2. **RQ2**：能否开发一种"碰撞检测"机制，识别情节事件何时威胁叙事一致性并触发适当干预？

3. **RQ3**：不同读者视角（逻辑型、直觉型、类型专家型）如何评估悬念质量？这种反馈能否改进生成？

---

## 2. 技术方案：SmokeMirror

我们提出 **SmokeMirror**，一个用于生成双层推理叙事的多阶段流水线框架。

### 2.1 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                    SmokeMirror 流水线                        │
├─────────────────────────────────────────────────────────────┤
│  阶段一：世界构建                                            │
│  ├── 犯罪背景生成器 → 真实事实（Ground Truth）               │
│  ├── 发现路径 → 通往真相的线索链                            │
│  └── 虚构叙事生成器 → 掩盖故事                              │
├─────────────────────────────────────────────────────────────┤
│  阶段二：悬念元控制器                                        │
│  ├── 侦探行动生成                                           │
│  ├── 碰撞检测器（真相暴露风险评估）                         │
│  ├── 共谋者干预（误导机制）                                 │
│  └── 发现路径管理                                           │
├─────────────────────────────────────────────────────────────┤
│  阶段三：故事组装                                            │
│  ├── 双层叙事编织                                           │
│  └── 读者层（真相） + 侦探层（幻象）                        │
├─────────────────────────────────────────────────────────────┤
│  阶段四：读者模拟与评估                                      │
│  ├── 逻辑分析师（推理质量）                                 │
│  ├── 直觉读者（情感投入）                                   │
│  └── 类型专家（节奏与结构）                                 │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 核心技术创新

#### 2.2.1 双层事实管理

我们维护两个并行的知识结构：
- **真实事实**：读者已知的真相（凶手身份、真实动机、证据的真实含义）
- **虚构事实**：共谋者构建的虚假叙事（假嫌疑人、伪造证据、掩盖故事）

系统确保侦探只能接触虚构事实，而读者揭示层展现真相。

#### 2.2.2 碰撞检测机制

在每个情节点生成时，检查侦探的调查是否威胁到真相暴露：

```python
def check_collision(detective_action, real_facts, open_discovery_paths):
    # 检查行动是否涉及调查共谋者
    # 检查行动是否检验关键证据
    # 检查行动是否沿发现路径接近真相
    → 返回: (是否碰撞, 脆弱点, 受威胁的共谋者)
```

当检测到碰撞时，系统触发**共谋者干预**：
- 转移侦探的注意力
- 提供虚假但合理的解释
- 关闭威胁性的发现路径

#### 2.2.3 发现路径管理

我们将侦探通往真相的潜在路线建模为**发现路径**：
- 每条路径代表一条通往真正凶手的证据/证人链
- 路径可以被**开启**（新线索出现）或**关闭**（共谋者干预）
- 当路径数 ≤ 阈值时故事结束（谜团未解）或侦探发现真相

#### 2.2.4 悬念曲线优化

我们在叙事过程中追踪悬念水平：
- **碰撞事件** → 提高悬念（接近发现创造张力）
- **成功干预** → 维持悬念同时增加戏剧性反讽
- **路径关闭** → 减少未来发现选项，提高风险

### 2.3 读者模拟

我们采用三种模拟读者视角评估生成的故事：

| 读者类型 | 关注点 | 评估标准 |
|---------|--------|----------|
| 逻辑分析师 | 推理 | 线索是否一致？谜团能否公平解开？ |
| 直觉读者 | 投入 | 角色是否可信？情感弧线是否满意？ |
| 类型专家 | 结构 | 节奏是否符合推理惯例？高潮是否earned？ |

每个读者提供：
- 每个情节点的悬念评分
- 检查点处的凶手预测
- 不一致性标记
- 参与度评估

---

## 3. 实验设计

### 3.1 研究假设

- **H1**：SmokeMirror生成的故事比基线LLM生成具有更高的读者感知悬念
- **H2**：碰撞检测机制产生更多戏剧性的"险些发现"时刻
- **H3**：双层叙事创造可测量的戏剧性反讽，增强参与度
- **H4**：多视角读者模拟与人类评估相关

### 3.2 基线方法

1. **Vanilla LLM**：直接提示Qwen3-32B生成推理故事
2. **Outline-then-Generate**：带显式情节大纲的两阶段生成
3. **Recursive Summarization**：带摘要上下文的分层生成
4. **Plan-and-Write**：带显式规划的目标导向故事生成

### 3.3 评估指标

#### 自动指标
| 指标 | 描述 |
|------|------|
| 悬念曲线 | 平均悬念分数、方差、趋势（上升/平坦/下降） |
| 碰撞率 | 接近发现事件的频率 |
| 路径关闭率 | 共谋者关闭发现路径的有效性 |
| 层泄漏检测 | 读者是否过早正确识别凶手 |
| 一致性分数 | 叙事的逻辑连贯性 |

#### 人类评估
- 悬念评分（1-10）
- 参与度评分（1-10）
- 戏剧性反讽识别
- 继续阅读意愿
- 整体质量排名

### 3.4 数据集

我们将生成和评估：
- 使用SmokeMirror生成 **50个故事**（不同犯罪类型、场景、阴谋规模）
- 每种基线方法生成 **50个故事**
- 每种方法抽取 **20个故事** 进行人类评估

---

## 4. 预期贡献

1. **新型框架**：首个显式设计用于双层推理叙事生成的系统，具有读者/角色知识分离机制。

2. **碰撞检测**：识别和管理情节一致性风险点的新机制。

3. **悬念建模**：量化测量和优化生成小说悬念曲线的方法。

4. **多视角评估**：捕获推理故事质量不同方面的读者模拟框架。

5. **基准与数据集**：带有悬念、一致性和双层结构标注的生成推理语料库。

---

## 5. 项目时间线

| 阶段 | 时间 | 活动 |
|------|------|------|
| 阶段1 | 第1-3周 | 系统实现，基线设置 |
| 阶段2 | 第4-6周 | 故事生成，自动评估 |
| 阶段3 | 第7-8周 | 人类评估研究 |
| 阶段4 | 第9-10周 | 分析，论文撰写 |

---

## 6. 资源需求

### 计算资源
- 4× NVIDIA A40 GPU（用于Qwen3-32B推理）
- 1× NVIDIA A40 GPU（用于读者模型评估）
- 预计：完整实验需要200+ GPU小时

### 人类评估
- 20-30名参与者进行故事评估
- 人类受试者研究的IRB批准

---

## 7. 更广泛影响

### 积极应用
- **创意写作辅助**：帮助作者开发复杂的推理情节
- **互动小说**：实现具有复杂分支叙事的游戏
- **教育工具**：教授叙事结构和悬念技巧

### 潜在风险
- 生成内容应明确标记为AI生成
- 系统可能被滥用于虚假信息（多重"真相"）
- 我们将附带负责任使用指南发布

---

## 8. 相关工作

### 长篇故事生成
- DOC (Yang et al., 2022): 详细大纲控制
- Re3 (Yang et al., 2022): 递归重新提示
- CONCOCT (Mirowski et al., 2023): 协作故事生成

### 情节与叙事规划
- PlotMachines (Rashkin et al., 2020): 基于大纲的生成
- STORIUM (Akoury et al., 2020): 基于游戏的故事生成
- Dramatron (Mirowski et al., 2023): 分层戏剧生成

### 推理与悬念
- 专门针对推理生成的先前工作有限
- 我们的工作首次显式建模双层知识和悬念

---

## 9. 结论

SmokeMirror解决了叙事AI中的重要空白：生成具有双重视角和受控悬念的结构复杂推理小说。通过引入碰撞检测、发现路径管理和多视角评估，我们使LLM能够产生具有定义推理类型的复杂戏剧性反讽的故事。

---

## 附录：输出结构示例

```
outputs/test_32b_YYYYMMDD_HHMMSS/
├── story.md                    # 最终双层叙事
├── plot_points.json            # 带悬念水平的结构化情节
├── facts.json                  # 真实 + 虚构事实
├── metrics.json                # 自动评估分数
├── reader_evaluations.json     # 多视角读者反馈
└── pipeline_logs/              # 生成中间步骤
    ├── pipeline_summary.json
    ├── crime_backstory_*.json
    ├── plot_point_*.json
    └── reader_eval_*.json
```
